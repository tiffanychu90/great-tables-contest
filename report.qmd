---
title: Quarto Basics
format:
  html:
    code-fold: false
jupyter: python3
---

```{python}
#| tags: []
import pandas as pd
import polars as pl
import polars.selectors as cs

from great_tables import GT
from great_tables import GT, loc, style, md
```

```{python}
#| tags: []
df = pl.read_parquet(
    f"./data/arrivals_polars.parquet"
)
```

```{python}
#| tags: []
(GT(df)
 .fmt_integer(columns = ["n_trips"])
 .data_color(
    columns=["n_trips"],
    palette=["white", "green"],
    na_color="lightgray"
 )
 .fmt_nanoplot(
     columns = "weekday_arrivals", 
     plot_type="line",
     reference_line="mean"
 )
 .fmt_nanoplot(
     columns = "weekend_arrivals", 
     plot_type="line",
     reference_line="mean"
 )
 .cols_label(
     name = "Transit Operator",
     n_trips = "Weekly Trips",
     weekday_arrivals = "Weekday Arrivals",
     weekend_arrivals = "Weekend Arrivals",
 )
 .tab_header(
     title = "Scheduled Stop Arrivals by Hour",
     subtitle = "weekday vs weekend totals"
 )
 .tab_source_note(
     source_note = "GTFS scheduled stop_times.txt"
    )
 .tab_source_note(
    source_note = md(
        "[GTFS specification](https://gtfs.org/schedule/reference/#stop_timestxt)"
    )
 )
)
```


